<script>
function istanbulNow(){
  return new Date(new Date().toLocaleString("en-US",{timeZone:"Europe/Istanbul"}));
}
function istanbulKey(){
  const n = istanbulNow();
  return `${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,'0')}-${String(n.getDate()).padStart(2,'0')}`;
}
function hashIndex(key, len){
  let h = 0;
  for(let i=0;i<key.length;i++) h = (h*31 + key.charCodeAt(i)) >>> 0;
  return h % len;
}

/* ðŸ“· FOTO LÄ°STESÄ° */
const photos = [
  { src:"assets/yunis/01.jpg", caption:"Deneme 1" },
  { src:"assets/yunis/02.jpg", caption:"Deneme 2" },
  { src:"assets/yunis/03.jpg", caption:"Deneme 3" },
];

/* ðŸ’Œ YAZILAR */
const entries = [
  {
    text:`BugÃ¼n seni sevdiÄŸimi ispatlamak iÃ§in bir ÅŸey yapmam gerekmiyor.
Sevgi bazen sessizce yanÄ±nda durabilmek.`,
    source:"Dammy â†’ Yunis",
    remember:"BugÃ¼n kÃ¼Ã§Ã¼k bir ÅŸey yap: â€˜iyi ki varsÄ±nâ€™ de."
  },
  {
    text:`Seninle konuÅŸurken cÃ¼mlelerim dÃ¼zgÃ¼n deÄŸilse,
sebebi TÃ¼rkÃ§em deÄŸil.
KafamÄ±n iÃ§i â€˜Yunisâ€™ diye baÄŸÄ±rÄ±yor.`,
    source:"Dammy â†’ Yunis"
  },
  {
    text:`Birlikte bÃ¼yÃ¼mek bazen kolay deÄŸil.
Ama ben â€˜kolayâ€™ diye deÄŸil,
â€˜senâ€™ diye seÃ§tim.`,
    source:"Dammy â†’ Yunis",
    remember:"BugÃ¼n ÅŸu soruyu sor: â€˜Bunu senin iÃ§in daha iyi nasÄ±l yaparÄ±m?â€™"
  }
];

document.addEventListener("DOMContentLoaded", () => {
  // Tema
  const hour = istanbulNow().getHours();
  if(hour >= 6 && hour < 19) document.body.classList.add("day");

  // Cuma dokusu (sende varsa)
  if(istanbulNow().getDay() === 5) document.body.classList.add("friday");

  const key = istanbulKey();

  // âœ… Eski ÅŸablon uyumu: Ã¶nce id ile ara, yoksa class ile yakala
  const msgEl  = document.getElementById("msg")  || document.querySelector(".msg");
  const dateEl = document.getElementById("date") || document.querySelector(".date");

  if(!msgEl || !dateEl){
    console.error("HÃ¢lÃ¢ DOM eksik. Sayfada #msg ve #date yok.", { msgEl, dateEl });
    return;
  }

  // GÃ¼nlÃ¼k sabit yazÄ±
  const eIdx = hashIndex(key + "|entry", entries.length);
  const entry = entries[eIdx];

  msgEl.textContent = entry.text;
  dateEl.textContent = `GÃ¼nÃ¼n notu â€¢ ${key}`;

  // Uzun metinde font kÃ¼Ã§Ã¼lt
  if(entry.text.length > 700) msgEl.style.fontSize="18px";
  if(entry.text.length > 1000) msgEl.style.fontSize="17px";

  // âœ… Foto gÃ¶stermek istiyorsan (senin mevcut HTMLâ€™de img yoksa otomatik ekler)
  const wrap = document.querySelector(".wrap") || document.body;

  // Foto alanÄ± yoksa oluÅŸtur
  let img = document.getElementById("lovePhoto");
  if(!img){
    img = document.createElement("img");
    img.id = "lovePhoto";
    img.style.width = "100%";
    img.style.height = "auto";
    img.style.maxHeight = "420px";
    img.style.objectFit = "cover";
    img.style.borderRadius = "16px";
    img.style.marginBottom = "14px";
    img.style.border = "1px solid var(--border)";
    wrap.insertBefore(img, wrap.firstChild);
  }

  // GÃ¼nlÃ¼k sabit foto
  if(photos.length > 0){
    const pIdx = hashIndex(key + "|photo", photos.length);
    img.src = photos[pIdx].src;
    img.alt = "BugÃ¼nÃ¼n fotoÄŸrafÄ±";
  }
});
</script>
