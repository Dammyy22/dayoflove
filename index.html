<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Bir Hediye</title>

<style>
body{
margin:0;
background:#081229;
font-family:system-ui;
color:#eef3fb;
display:flex;
align-items:center;
justify-content:center;
height:100vh;
}

/* kart */
.card{
width:520px;
max-width:95%;
background:#0c1a34;
border-radius:20px;
padding:18px;
box-shadow:0 20px 70px rgba(0,0,0,.6);
}

.photo{
width:100%;
height:340px;
object-fit:contain;
border-radius:14px;
background:#0003;
}

.msg{margin-top:12px;font-size:18px}

.row{display:flex;gap:8px;margin-top:12px;flex-wrap:wrap}

button{
flex:1;
padding:10px;
border-radius:10px;
border:none;
cursor:pointer;
background:#1d2e55;
color:white;
font-weight:700;
}

button:hover{background:#2b4586}

/* kavanoz ikon */
.jar{
position:fixed;
bottom:20px;
width:92px;
height:110px;
cursor:pointer;
}

/* sol ÅŸiÅŸe */
#btnJar{left:20px}

/* saÄŸ kavanoz */
#btnQuoteJar{right:20px}

/* modal */
.modal{
position:fixed;
inset:0;
display:none;
align-items:center;
justify-content:center;
background:#0008;
}
.modal.show{display:flex}

.box{
background:#0e1c36;
padding:20px;
border-radius:18px;
width:420px;
max-width:95%;
}

textarea{
width:100%;
height:90px;
border-radius:10px;
padding:10px;
resize:none;
}

.qitem{
background:#142448;
padding:10px;
border-radius:10px;
margin-top:10px;
}

.qmeta{
font-size:12px;
opacity:.7;
display:flex;
justify-content:space-between;
margin-bottom:6px;
}

/* ===== ÅžÄ°ÅžE TASARIM ===== */

#btnJar .bottle{
position:absolute;
left:50%;
top:10px;
transform:translateX(-50%);
width:72px;
height:95px;
}

#btnJar .neck{
position:absolute;
left:50%;
top:-10px;
transform:translateX(-50%);
width:26px;
height:25px;
border-radius:14px;
background:linear-gradient(#fff3,#fff1);
border:1px solid #fff3;
}

#btnJar .body{
position:absolute;
top:10px;
width:100%;
height:85px;
border-radius:20px 20px 28px 28px;
background:linear-gradient(#fff3,#fff1);
border:1px solid #fff3;
box-shadow:0 15px 30px #0007;
}

#btnJar .cork{
position:absolute;
top:-20px;
left:50%;
transform:translateX(-50%);
width:30px;
height:15px;
border-radius:8px;
background:linear-gradient(#d2b07c,#9b6b3d);
border:1px solid #0004;
}

#btnJar .scroll{
position:absolute;
left:50%;
top:45px;
transform:translateX(-50%) rotate(-8deg);
width:44px;
height:24px;
border-radius:12px;
background:#fff;
box-shadow:0 10px 20px #0007;
}

#btnJar .scroll:before,
#btnJar .scroll:after{
content:"";
position:absolute;
top:50%;
transform:translateY(-50%);
width:12px;
height:12px;
border-radius:50%;
background:#fff;
}
#btnJar .scroll:before{left:-6px}
#btnJar .scroll:after{right:-6px}

#btnJar{
animation:float 4s ease-in-out infinite;
}
@keyframes float{
0%,100%{transform:translateY(0)}
50%{transform:translateY(-6px)}
}

/* saÄŸ kavanoz basit */
#btnQuoteJar{
font-size:46px;
display:flex;
align-items:center;
justify-content:center;
}
</style>
</head>

<body>

<div class="card">
<img id="photo" class="photo">
<div id="message" class="msg"></div>

<div class="row">
<button id="btnNew">Yeni getir</button>
<button id="btnMusic">MÃ¼zik</button>
</div>
</div>

<!-- SOL ÅžÄ°ÅžE -->
<div class="jar" id="btnJar">
<div class="bottle">
<div class="cork"></div>
<div class="neck"></div>
<div class="body"></div>
<div class="scroll"></div>
</div>
</div>

<!-- SAÄž NOT KAVANOZU -->
<div class="jar" id="btnQuoteJar">ðŸ«™</div>

<!-- NOT MODAL -->
<div class="modal" id="modal">
<div class="box">

<textarea id="qInput" placeholder="Not yaz..."></textarea>

<div class="row">
<button id="btnAdd">Ekle</button>
<button id="btnRefresh">Yenile</button>
<button id="btnClose">Kapat</button>
</div>

<div id="qStatus" style="margin-top:6px;font-size:12px;opacity:.7">Durum: â€”</div>
<div id="qList"></div>

</div>
</div>

<script>
/* foto + mesaj */
const msgs=["Seni seviyorum.","Ä°yi ki varsÄ±n.","Ã–zledim.","Kalbim sen.","YanÄ±ndayÄ±m."];
function rand(a){return a[Math.floor(Math.random()*a.length)]}
function newCard(){
photo.src=`assets/yunis/${String(Math.floor(Math.random()*119)+1).padStart(4,"0")}.jpg`;
message.textContent=rand(msgs);
}
btnNew.onclick=newCard;
newCard();

/* mÃ¼zik */
const audio=new Audio("assets/music.mp3");
audio.loop=true;
btnMusic.onclick=()=>audio.paused?audio.play():audio.pause();

/* modal */
btnQuoteJar.onclick=()=>modal.classList.add("show");
btnClose.onclick=()=>modal.classList.remove("show");

/* kullanÄ±cÄ± */
const KEY="dayoflove_author";
let USER=localStorage.getItem(KEY)||"Yummy";
(()=>{
let u=new URL(location);
if(u.searchParams.get("i")==="dammy"){
localStorage.setItem(KEY,"Dammy");
USER="Dammy";
u.searchParams.delete("i");
history.replaceState({},'',u);
}
})();

/* api */
const PAGE="yunis";

async function loadNotes(){
qStatus.textContent="yÃ¼kleniyor...";
try{
let r=await fetch(`/api/notes?page=${PAGE}`);
let data=await r.json();
qList.innerHTML="";
data.notes.forEach(n=>{
let d=document.createElement("div");
d.className="qitem";
d.innerHTML=`
<div class=qmeta>
<span>${n.author||"?"}</span>
<span>${new Date(n.created_at).toLocaleString()}</span>
</div>
<div>${n.text}</div>
`;
qList.appendChild(d);
});
qStatus.textContent=data.notes.length+" not";
}catch{
qStatus.textContent="baÄŸlantÄ± yok";
}
}

btnRefresh.onclick=loadNotes;

btnAdd.onclick=async()=>{
let text=qInput.value.trim();
if(!text)return;
await fetch(`/api/notes?page=${PAGE}`,{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({text,author:USER})
});
qInput.value="";
loadNotes();
};

loadNotes();
</script>

</body>
</html>
