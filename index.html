<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>NFC Sayfa</title>
  <style>
    :root{
      --bg1:#07111f;
      --bg2:#0b1a33;
      --card:rgba(12, 25, 46, 0.74);
      --text:#eef3fb;
      --muted:rgba(238,243,251,0.55);
      --shadow:rgba(0,0,0,0.55);
      --border:rgba(255,255,255,0.10);
      --glow:rgba(140,180,255,0.18);
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--text);
      background: radial-gradient(1200px 600px at 20% 10%, rgba(140,180,255,0.12), transparent 60%),
                  linear-gradient(180deg, var(--bg1), var(--bg2));
      padding:18px;
    }

    .card{
      width:min(520px, 100%);
      background:var(--card);
      border:1px solid var(--border);
      border-radius:18px;
      box-shadow:0 18px 55px var(--shadow);
      padding:16px;
      backdrop-filter: blur(10px);
    }

    .photo-frame{
      /* ðŸ‘‡ Ã‡ERÃ‡EVEYÄ° BÃœYÃœT + UZAT */
      width:100%;
      height: clamp(340px, 58vh, 560px); /* uzun */
      border-radius:16px;
      border:1px solid rgba(255,255,255,0.12);
      overflow:hidden;
      background:
        radial-gradient(700px 260px at 50% 30%, rgba(140,180,255,0.18), transparent 70%),
        rgba(255,255,255,0.04);
      box-shadow: 0 14px 40px rgba(0,0,0,0.35);
      padding:10px; /* fotoÄŸraf kenara yapÄ±ÅŸmasÄ±n */
      display:flex;
      align-items:center;
      justify-content:center;
    }

    .photo-frame img{
      width:100%;
      height:100%;
      /* ðŸ‘‡ KIRPMA YOK: FOTOÄžRAF Ã‡ERÃ‡EVEYE ORANLA SIÄž */
      object-fit: contain;
      object-position: center;
      border-radius:12px; /* padding iÃ§inde daha tatlÄ± gÃ¶rÃ¼nÃ¼r */
      display:block;
      user-select:none;
      -webkit-user-drag:none;
    }

    .msg{
      margin:14px 6px 0;
      font-size:1.08rem;
      line-height:1.45;
      color:var(--text);
    }

    .sub{
      margin:8px 6px 0;
      font-size:0.9rem;
      color:var(--muted);
    }

    .row{
      display:flex;
      gap:10px;
      margin-top:12px;
    }

    button{
      flex:1;
      border:1px solid rgba(255,255,255,0.14);
      background: rgba(255,255,255,0.06);
      color: var(--text);
      border-radius:12px;
      padding:10px 12px;
      cursor:pointer;
    }
    button:hover{
      background: rgba(255,255,255,0.10);
    }
  </style>
</head>
<body>
  <div class="card">
    <div class="photo-frame">
      <img id="photo" alt="fotoÄŸraf" />
    </div>

    <div class="msg" id="message"></div>
    <div class="sub">Yenileyince yeni mesaj + foto gelir.</div>

    <div class="row">
      <button id="btnNew">Yeni getir</button>
      <button id="btnReset">Listeyi sÄ±fÄ±rla</button>
    </div>
  </div>

  <script>
    // =======================
    //  MEVCUT MANTIÄžI BOZMADAN
    //  - localStorage shuffle / tekrarsÄ±z mesaj
    //  - tekrarsÄ±z foto
    //  - assets/yunis/0001.jpg formatÄ±
    // =======================

    // Ã–rnek mesaj listesi (senin gerÃ§ek listen burada olacak)
    const MESSAGES = [
      "BugÃ¼n de seni seviyorum.",
      "Kalbimden geÃ§enler: iyi ki varsÄ±n.",
      "Biraz susup sarÄ±lasÄ±m var.",
      "GÃ¼lÃ¼ÅŸÃ¼n dÃ¼nyayÄ± dÃ¼zeltemiyor ama beni dÃ¼zeltiyor."
    ];

    // Foto ayarlarÄ±: assets/yunis/0001.jpg ... 00NN.jpg
    const PHOTO_DIR = "assets/yunis/";
    const PHOTO_START = 1;
    const PHOTO_END = 60; // sende kaÃ§ foto varsa o sayÄ±

    // ---------- helpers ----------
    function pad4(n){ return String(n).padStart(4,"0"); }

    function lsGet(key, fallback){
      try{
        const v = localStorage.getItem(key);
        return v ? JSON.parse(v) : fallback;
      }catch(e){
        return fallback;
      }
    }

    function lsSet(key, value){
      localStorage.setItem(key, JSON.stringify(value));
    }

    function shuffle(arr){
      // Fisherâ€“Yates
      for(let i=arr.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [arr[i],arr[j]] = [arr[j],arr[i]];
      }
      return arr;
    }

    // ---------- tekrarsÄ±z havuz sistemi ----------
    function getNextFromPool(poolKey, sourceArray){
      let pool = lsGet(poolKey, null);
      if(!Array.isArray(pool) || pool.length === 0){
        pool = shuffle([...sourceArray]);
      }
      const next = pool.pop();
      lsSet(poolKey, pool);
      return next;
    }

    function resetPool(poolKey){
      localStorage.removeItem(poolKey);
    }

    // ---------- mesaj ----------
    function nextMessage(){
      return getNextFromPool("msg_pool", MESSAGES);
    }

    // ---------- foto ----------
    function buildPhotoList(){
      const arr = [];
      for(let i=PHOTO_START;i<=PHOTO_END;i++){
        arr.push(PHOTO_DIR + pad4(i) + ".jpg");
      }
      return arr;
    }
    const PHOTO_LIST = buildPhotoList();

    function nextPhoto(){
      return getNextFromPool("photo_pool", PHOTO_LIST);
    }

    // ---------- render ----------
    function renderNew(){
      const msg = nextMessage();
      const photoPath = nextPhoto();

      document.getElementById("message").textContent = msg;

      const img = document.getElementById("photo");
      img.src = photoPath;

      // kÄ±rpma artÄ±k yok ama yine de yÃ¼klenmezse fallback
      img.onerror = () => {
        img.onerror = null;
        img.src = PHOTO_DIR + "0001.jpg";
      };
    }

    // init
    renderNew();

    // actions
    document.getElementById("btnNew").addEventListener("click", renderNew);
    document.getElementById("btnReset").addEventListener("click", () => {
      resetPool("msg_pool");
      resetPool("photo_pool");
      renderNew();
    });

    // Yenilemede otomatik zaten Ã§alÄ±ÅŸÄ±r (renderNew init'te)
  </script>
</body>
</html>
